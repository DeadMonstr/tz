"use client"


import {Input} from "@/components/ui/input";
import {Label} from "@/components/ui/label";
import {Button} from "@/components/ui/button";
import Link from "next/link";
import {Checkbox} from "@/components/ui/checkbox";
import {useState} from "react";
import {useRouter} from "next/navigation";
import {User} from "@/lib/types";
import {signInAction} from "@/lib/actions";


export default function SignIn() {


    const [error, setError] = useState("");
    const router = useRouter();

    const handleSignIn = async (formData: FormData) => {
        setError("");

        const user: User = {
            username: formData.get("username") as string,
            password: formData.get("password") as string
        }

        try {
            const res = await signInAction(user);
            if (!res.success) {
                setError(res.message);
                return;
            }
            router.push("/orders");
        } catch (err) {
            console.error(err);
            setError("Something went wrong");
        }
    };


    return (
        <form action={handleSignIn} className={"w-full flex flex-col gap-5"}>
            <h2 className={"text-red-500"}>{error}</h2>
            <div className={"flex flex-col gap-4 text-white/70"}>
                <Label  htmlFor="username">Username</Label>
                <Input required name={"username"} className={"border-neutral-600"} type="username" id="username" placeholder="Username" />
            </div>
            <div className={"flex flex-col gap-4 text-white/70"}>
                <Label htmlFor="password">Password</Label>
                <Input required name={"password"} className={"border-neutral-600"} type="password" id="password" placeholder="Password" />
            </div>

            <div className={"flex items-center justify-between"}>
                <div className={" flex gap-4"}>
                    <Checkbox id="remember"/>
                    <Label className={"text-white"} htmlFor="remember">Remember me</Label>
                </div>

                <Link className={"text-blue-500"} href={"/forgot-password"}>Forgot your password?</Link>

            </div>

            <Button className={"w-full bg-blue-500"} type={"submit"} >Sign In</Button>
        </form>
    )
}